@using Microsoft.AspNet.Identity
@model Schemes.ViewPost
@{
    ViewBag.Title = "PostPage";
}
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" src="rating.css" />
<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="rating.js"></script>

<h2>Пост</h2>
<p class="text-success">@ViewBag.StatusMessage</p>
<div>
    <hr />
    <dl class="dl-horizontal">
        <dt>Автор:</dt>
        <dd>
            @Html.ActionLink(Model.UserEmail, "UserPage", "Account", new { id = Model.post.UserId }, null)
        </dd>
        <dt>Заголовок:</dt>
        <dd>
            @Model.post.title
        </dd>
        <dt>Тема:</dt>
        <dd>
            @Model.post.teme
        </dd>
        <dt>Тэги:</dt>
        <dd>
            @Model.post.tags
        </dd>

        @if (Model.picture.Image != null)
        {
            <td>
                @Html.Raw(Model.picture.HtmlRaw
                        + Convert.ToBase64String(Model.picture.Image) + "\" />")
            </td>
        }

        <dt>Описание:</dt>
        <dd>
            @Model.post.description
        </dd>
        <dt>Рейтинг:</dt>
        <dd>
            @Model.post.rating.ToString()
        </dd>
        <dt>Дата создания:</dt>
        <dd>
            @Model.post.time
        </dd>
    </dl>
    <div id="star-rating">
        <input type="radio" name="example" class="rating" value="1" />
        <input type="radio" name="example" class="rating" value="2" />
        <input type="radio" name="example" class="rating" value="3" />
        <input type="radio" name="example" class="rating" value="4" />
        <input type="radio" name="example" class="rating" value="5" />
    </div>
</div>
@Html.Partial("Comments")

@if ((Model.post.UserId == User.Identity.GetUserId()) || (User.IsInRole("admin")))
{
    using (Html.BeginForm("CreatePost", "Post", FormMethod.Get))
    {
        <input type="hidden" name="id" value=@Model.post.id />
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input id="ButtonChange" type="submit" class="btn btn-default" value="Отредактировать пост" />
            </div>
        </div>
    }
    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input id="ButtonDelete" type="button" value="Удалить пост" class="btn btn-default" onclick="if (confirm('Вы уверен, что хотите удалить этот пост?')) location.href='@Url.Action("DeletePost", "Post", new { id = Model.post.id })'" />
        </div>
    </div>
}

