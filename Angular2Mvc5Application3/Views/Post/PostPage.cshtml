@using Microsoft.AspNet.Identity
@model Schemes.ViewPost
@{
    ViewBag.Title = "PostPage";
}
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" src="rating.css" />
<script type="text/javascript" src="~/Scripts/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="~/Scripts/bootstrap-rating/bootstrap-rating.js"></script>

<h2>Пост</h2>
<p class="text-success">@ViewBag.StatusMessage</p>
<div>
    <hr />
    <dl class="dl-horizontal">
        <dt>Автор:</dt>
        <dd>
            @Html.ActionLink(Model.UserEmail, "UserPage", "Account", new { id = Model.post.UserId }, null)
        </dd>
        <dt>Заголовок:</dt>
        <dd>
            @Model.post.title
        </dd>
        <dt>Тема:</dt>
        <dd>
            @Model.post.teme
        </dd>
        <dt>Тэги:</dt>
        <dd>
            @Model.post.tags
        </dd>

        @if (Model.picture.Image != null)
        {
            <td>
                @Html.Raw(Model.picture.HtmlRaw
                        + Convert.ToBase64String(Model.picture.Image) + "\" />")
            </td>
        }

        <dt>Описание:</dt>
        <dd>
            @Model.post.description
        </dd>
        <dt>Рейтинг:</dt>
        <dd>
            @Model.post.rating.ToString()
        </dd>
        <dt>Дата создания:</dt>
        <dd>
            @Model.post.time
        </dd>
    </dl>
</div>
@{
    var url = Request.Url.AbsolutePath;
}
<div class="tr" style="background-color:#f1f1f1;">
    <div class="td">@Html.Partial("_VoteNow", Model.post.id.ToString())</div>
    @if (Request.Cookies[url] != null)
    {
    <div class="td">@Html.Partial("_VoteShow", Model.post.Votes)</div>
    }
</div>

<!doctype html>
<html ng-app="todoApp">
<head>
    <script src="~/Scripts/angular.js"></script>
    <script src="~/Scripts/todo.js"></script>
</head>
<body>
    <h2>Todo</h2>
    <div ng-controller="TodoListController as todoList">
        <form ng-submit="todoList.addTodo()">
            <input type="text" ng-model="todoList.todoText" size="30"
                   placeholder="add new comment here" id="Add">
            <input class="btn-primary" type="submit" value="add">
        </form>
        <form ng-submit="todoList.GetComments()"></form>
        <dl class="dl-horizontal">
            <dd ng-repeat="todo in todoList.todos">
                <div class="thumbnail">
                    <div class="col">
                        <dl class="dl-horizontal">
                            <dd>
                                {{todo.EmailAutor}}
                            </dd>
                            <dd>
                                {{todo.CommentText}}
                            </dd>
                            <dd>
                                {{todo.time}}
                            </dd>
                            <
                        </dl>
                    </div>
                </div>
            </dd>

        </dl>

        <label text="text" runat="server" />
    </div>
</body>
</html>

@if ((Model.post.UserId == User.Identity.GetUserId()) || (User.IsInRole("admin")))
{
    using (Html.BeginForm("CreatePost", "Post", FormMethod.Get))
    {
        <input type="hidden" name="id" value=@Model.post.id />
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input id="ButtonChange" type="submit" class="btn btn-default" value="Отредактировать пост" />
            </div>
        </div>
    }
    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input id="ButtonDelete" type="button" value="Удалить пост" class="btn btn-default" onclick="if (confirm('Вы уверен, что хотите удалить этот пост?')) location.href='@Url.Action("DeletePost", "Post", new { id = Model.post.id })'" />
        </div>
    </div>
}

